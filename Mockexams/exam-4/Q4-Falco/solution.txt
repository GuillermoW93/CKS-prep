On the exam Falco is probably installed, but if you want to practise on your lab install it first:

curl -fsSL https://falco.org/repo/falcosecurity-packages.asc | \
  gpg --dearmor -o /usr/share/keyrings/falco-archive-keyring.gpg

echo "deb [signed-by=/usr/share/keyrings/falco-archive-keyring.gpg] https://download.falco.org/packages/deb stable main" | \
  tee /etc/apt/sources.list.d/falcosecurity.list

apt-get update
apt-get install -y falco

Verify it is running:
- systemctl status falco

Next, find the 'rule' (Shell). Remember Falco and it's rules live in '/etc/falco/' 

grep "shell" /etc/falco/falco_rules.yaml | grep rule:
- rule: Run shell untrusted
- rule: Terminal shell in container

Copy the rule "Terminal shell in container" and paste in falco_rules.local.yaml

# Your custom rules!

- rule: Terminal shell in container
  desc: >
    A shell was used as the entrypoint/exec point into a container with an attached terminal. Parent process may have 
    legitimately already exited and be null (read container_entrypoint macro). Common when using "kubectl exec" in Kubernetes. 
    Correlate with k8saudit exec logs if possible to find user or serviceaccount token used (fuzzy correlation by namespace and pod name). 
    Rather than considering it a standalone rule, it may be best used as generic auditing rule while examining other triggered 
    rules in this container/tty.
  condition: >
    spawned_process 
    and container
    and shell_procs 
    and proc.tty != 0
    and container_entrypoint
    and not user_expected_terminal_shell_in_container_conditions
  output: CRITICAL: SHELL OPENEND | evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags
  priority: CRITICAL
  tags: [maturity_stable, container, shell, mitre_execution, T1059]

Verify, by restarting Falco:
- systemctl restart falco

sudo /usr/bin/falco -o engine.kind=modern_ebpf

journalctl -u falco-modern-bpf (troubleshoot command if you have typo's in your falco_rules.local.yaml and the Falco service will not start)
